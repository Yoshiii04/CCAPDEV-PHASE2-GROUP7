{{> header_nav}}
<div class="Post">

    <div class="Header">
        <form action="/main" method="GET">
            <input type="image" src="/postimages/left-arrow.png" alt="Submit">
        </form>
        <form action="../viewUserProfilePage/view-user-profile-page.html" method="GET">
            <input type="image" src="/postimages/user.png" alt="Submit">
        </form>
        <div class="Profile-info">
            <div class="User-info">
                <span class="Username">{{post.username}}</span>
                <div class="Space"></div> 
                <span class="Username"> <span style="color:#ecfeefa4;">{{_id}}</span></span></span>
            </div>
        </div>

        <div class="dropdown">
            <button class="dropbtn">
                <img src="/postimages/dots.png" alt="dots">
            </button>
            <div class="dropdown-content">
                <a href="#" onclick="myFunction();">Edit</a>
                <a href="#" onclick="myFunction();">Delete</a>
            </div>
            </div>
        </div>

 

    <div class="Content">

        <div class="Title">
            <h1>{{post.title}}</h1>
        </div>

        <div class="Tags">
            <button class="Tag-button">{{post.tag}}</button>
        </div>

        <div class="Description">
            <p>{{post.description}}</p>
        </div>

        <div class="Icons">

            <div class="vote-container">

                <button class="vote-button upvote" onclick="toggleUpvote()">
                    <svg viewBox="0 0 24 18">
                        <path d="M12 2l-6 6h4v8h4v-8h4l-6-6z"></path>
                    </svg>
                </button>
                <div id="vote-count">0</div>
                <button class="vote-button downvote" onclick="toggleDownvote()">
                    <svg viewBox="0 0 24 24">
                        <path d="M12 22l6-6h-4v-8h-4v8h-4l6 6z"></path>
                    </svg>
                </button>

            </div>

        </div>

    </div>

    <div class="Footer">

        <div class="Add-comment-container">
            
            <form name="create-comment" action="/create-comment/{{post._id}}" method="post" class="comment-box">

                <textarea name="comment"></textarea>
                <input type="hidden" name="username" value="{{username}}">
                <input type="hidden" name="postId" value="{{post._Id}}">
                <button type="submit" class="comment-submit">Comment</button>

            </form>

        </div>

        <div class="comment-section">
            {{#each comments}}
            <div class="comment-container">
                <div class="Header">
                    <form action="../viewUserProfilePage/view-user-profile-page.html" method="GET">
                        <input type="image" src="/postimages/user.png" alt="Submit">
                    </form>
                    <div class="Profile-info">
                        <div class="User-info">
                            <span class="Username">{{username}}</span>
                            <div class="Space"></div>
                            <span class="Username"> <span style="color:#ECFEEF;">{{createdAt}}</span></span>
                        </div>
                    </div>
                    <div class="dropdown">
                            <button class="dropbtn">
                                <img src="/postimages/dots.png" alt="dots">
                            </button>
                            <div class="dropdown-content">
                                <a href="/reply">Reply</a>
                            </div>
                            </div>
                        </div> 
                </div>
                <div class="Content">
                    <div class="comment">
                        <p>{{text}}</p>
                    </div>
                </div>
                <div class="Icons">
                    <div class="vote-container">
                        <button class="vote-button upvote" onclick="toggleUpvote()">
                            <svg viewBox="0 0 24 18">
                                <path d="M12 2l-6 6h4v8h4v-8h4l-6-6z"></path>
                            </svg>
                        </button>
                        <div id="vote-count">0</div>
                        <button class="vote-button downvote" onclick="toggleDownvote()">
                            <svg viewBox="0 0 24 24">
                                <path d="M12 22l6-6h-4v-8h-4v8h-4l6 6z"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
            {{/each}}
        </div>

    </div>

</div>
<script> 
// needs revision for this part 
/**function confirmAndDelete(postId, username, currentUser) {
    if (confirm('Are you sure you want to delete this post?')) {
        fetch(`/view-post/delete/${postId}?user=${currentUser}`, {
            method: 'GET',
        })
        .then(response => {
            if (response.ok) {
                alert('Post marked as deleted');
                window.location.href = '/read-user'; // Redirect to main page after successful deletion
            } else {
                console.error('Failed to mark post as deleted:', response.statusText);
                alert('Failed to mark post as deleted. Please try again.');
            }
        })
        .catch(error => {
            console.error('Error marking post as deleted:', error);
            alert('Error marking post as deleted. Please try again.');
        });
    } else {
        return false; // Cancel action
    }
}
**/ 

function myFunction() {
	    alert("This feature is still in progress!");
    }


</script> 